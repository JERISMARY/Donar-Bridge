<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Request Blood</title>
<style>
/* Animated pinkish gradient background */
body, html {
    height: 100%;
    margin: 0;
    font-family: 'Arial', sans-serif;
    overflow-x: hidden;
    position: relative;
}

body {
    background: linear-gradient(-45deg, #ffb6c1, #ff69b4, #ffc0cb, #ff1493);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
}

@keyframes gradientBG {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
}

/* Particle blood drops (floating circles) */
.drop {
    position: absolute;
    width: 10px;
    height: 10px;
    background: rgba(255, 0, 51, 0.263);
    border-radius: 50%;
    animation: floatDrop linear infinite;
    z-index: -1;

}

@keyframes floatDrop {
    0% {transform: translateY(0px) translateX(0px);}
    100% {transform: translateY(-1200px) translateX(20px);}
}

/* Page container */
.container {
    max-width: 1000px;
    margin: auto;
    padding: 20px;
    z-index: 10;
}

/* Form styling */
.form-container {
    background: rgba(255,255,255,0.95);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    z-index: 10;
}

input {
    width: calc(100% - 20px);
    padding: 10px;
    margin: 5px 0;
    border-radius: 5px;
    border: 1px solid #ccc;
}

button {
    padding: 12px 20px;
    margin-top: 10px;
    background-color: #ff1493;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    transition: 0.3s;
}

button:hover {
    background-color: #ff69b4;
}

/* Donor cards with flip effect */
#donorCards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
    z-index: 19;
}

.card {
    perspective: 1000px;
    width: 220px;
    height: 250px;
}

.card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.8s;
    transform-style: preserve-3d;
}

.card:hover .card-inner {
    transform: rotateY(180deg);
}

.card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.card-front {
    background: #fff;
}

.card-back {
    background: #ffe4e1;
    transform: rotateY(180deg);
}

.status-badge {
    font-size: 12px;
    color: #555;
    position: absolute;
    top: 10px;
    right: 10px;
}

/* Blood type gradient borders */
.blood-A { border: 3px solid #ff7f7f; }
.blood-B { border: 3px solid #ff4d4d; }
.blood-AB { border: 3px solid #ff1a75; }
.blood-O { border: 3px solid #ff0066; }

.contact-info {
    font-size: 14px;
    text-align: center;
}
</style>
</head>
<body>

<div class="container">
    <div class="form-container">
        <h2>Request Blood</h2>
        <input type="text" id="reqBlood" placeholder="Required Blood Type (e.g., A+, O-)">
        <input type="text" id="reqLocation" placeholder="Your City or Village">
        <button id="requestBtn">Find Donors</button>
        <button style="background:#555;margin-left:10px;" onclick="location.href='index.html'">Back to Home</button>
    </div>

    <div id="donorList">
        <h2 style="color:white;">Verified Donors Nearby</h2>
        <div id="donorCards"></div>
    </div>
</div>

<script>
// Floating particles
for(let i=0;i<50;i++){
    let drop = document.createElement('div');
    drop.className = 'drop';
    drop.style.left = Math.random()*100+'vw';
    drop.style.top = Math.random()*100+'vh';
    drop.style.animationDuration = (5 + Math.random()*10)+'s';
    drop.style.width = drop.style.height = (5 + Math.random()*10)+'px';
    document.body.appendChild(drop);
}

// Donor display
const reqBlood = document.getElementById('reqBlood');
const reqLocation = document.getElementById('reqLocation');
const requestBtn = document.getElementById('requestBtn');
const donorCards = document.getElementById('donorCards');

let donors = JSON.parse(localStorage.getItem('donors')) || [];

requestBtn.addEventListener('click', () => {
    donorCards.innerHTML = '';
    const bloodType = reqBlood.value.toUpperCase();
    const location = reqLocation.value.toLowerCase();

    const filteredDonors = donors.filter(d => 
        d.blood === bloodType && 
        d.location.includes(location) && 
        d.verified
    );

    if (filteredDonors.length === 0) {
        donorCards.innerHTML = `<p style="color:white;">No verified donors found nearby.</p>`;
        return;
    }

    filteredDonors.forEach(d => {
        const lastDonationDate = new Date(d.lastDonation);
        const today = new Date();
        const diffMonths = (today - lastDonationDate)/(1000*60*60*24*30);

        let statusBadge = '';
        if(diffMonths < 1) statusBadge = 'Donated <1 month ago';

        const card = document.createElement('div');
        card.className = 'card';

        card.innerHTML = `
            <div class="card-inner blood-${d.blood.replace('+','P').replace('-','N')}">
                <div class="card-front">
                    <h3>${d.name}</h3>
                    <p>Blood: ${d.blood}</p>
                    <p>Location: ${d.location}</p>
                    <span class="status-badge">${statusBadge}</span>
                    <p style="font-size:12px;">Hover to see contact</p>
                </div>
                <div class="card-back">
                    <h3>Contact Info</h3>
                    <div class="contact-info">
                        üìß ${d.email}<br>
                        üìû ${d.phone}<br>
                        ü©∏ ${lastDonationDate.toDateString()}<br>
                        üìç ${d.location}
                    </div>
                </div>
            </div>
        `;
        donorCards.appendChild(card);
    });
});
</script>

</body>
</html>